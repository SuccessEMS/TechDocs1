<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title mt-export-translate="no">Configuring Skype for Business</title>
        <meta name="mt-type" value="application/x.deki-text" />
        <meta name="mt-unsafe" value="true" />
    </head>
    <body>
        <h1>
            <MadCap:concept term="V44.1" />Configure Skype for Business</h1>
        <p class="box-important"><span class="bold">IMPORTANT</span>:&#160;Skype for Business can now also be configured in the EMS&#160;Platform Services Admin UI. </p>
        <p>This topic provides information on the following: </p>
        <ul class="unorder-list">
            <li><a href="#SupportedSkypeProducts">Supported Skype Products</a>
            </li>
            <li><a href="#Prerequisites">Prerequisites</a>
                <ul>
                    <li><a href="#SkypeOnPremIntegration">Skype for Business Server 2015 (On-premise)&#160;Integration</a>
                    </li>
                    <li><a href="#SkypeOnline">Skype for Business Online Integration</a>
                    </li>
                </ul>
            </li>
            <li><a href="#Deployment_Types">Deployment Types</a>
            </li>
            <li><a href="#Integrate_with_the_Skype_for_Business_Server">Integrate with Skype for Business Server</a>
            </li>
            <li><a href="#Connect_EMS_Web_App_Platform_Services">Connect EMS Web App&#160;to Platform Services</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_Global_Templates">Configure Skype for Business on Global Templates</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_a_Process_Template_Level">Configure Skype for Business on a Process Template Level</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_Existing_Templates">Configure Skype for Business on Existing Templates</a>
            </li>
        </ul>
        <h2><a name="SupportedSkypeProducts"></a>Supported Skype Products</h2>
        <ul class="unorder-list">
            <li>Skype for Business Online</li>
            <li>Skype for Business Server (On-premise) Version 2015</li>
        </ul>
        <h2><a name="Prerequisites"></a>Prerequisites</h2>
        <h4><a name="SkypeOnPremIntegration"></a>Skype for Business Server 2015 (On-premise) Integration</h4>
        <ol class="number-list">
            <li>Ensure a SHA2 and above Algorithm certificate is installed and functional. SHA2 is required as major browsers <a href="https://securityintelligence.com/news/browsers-to-end-sha-1-support-in-2017/">no longer support SHA1.</a></li>
            <li>To provide a URL, navigate to the Platform Services Admin Page Conferencing tab. If a URL is not provided, EMS will build a URL based on the Everyday User's email address.</li>
        </ol>
        <p class="box-note"><span class="bold">NOTES</span>:&#160;Optionally, you can provide one or more URLs; multiple URLs must be separated by commas.<br /><br />Ensure you can access the URL without certificate errors (EMS&#160;Software recommends using the Google Chrome browser). AutoDiscover URL should return an xml file. If you experience certificate errors, please refer to the first step above. </p>
        <ol class="number-list" MadCap:continue="true">
            <li>Ensure all EMS components have been deployed:<ol style="list-style-type: lower-alpha;"><li>EMS Platform Services</li><li>EMS Web App (optional)<ol style="list-style-type: lower-roman;"><li><MadCap:variable name="General.Mobile" /> (optional)</li><li><MadCap:variable name="General.EMS&#160;Desktop Client" /></li><li>Integration to Microsoft Exchange</li></ol></li></ol></li>
        </ol>
        <h4><a name="SkypeOnline"></a>Skype for Business Online Integration</h4>
        <ol class="number-list">
            <li>Microsoft Azure Active Directory.</li>
            <li>Admin access to Azure environment. </li>
            <li>EMS Conferencing URI (mostly to be something like this (https://servernamefqdn/web app directory/ConferencingLogin.aspx/). This URI <span class="bold">must </span>be verifiable and accessible externally.</li>
            <li>Ensure all EMS&#160;components have been deployed:<ol style="list-style-type: lower-alpha;"><li>EMS Platform Services</li><li>EMS&#160;Web App (optional)<ol style="list-style-type: lower-roman;"><li><MadCap:variable name="General.Mobile" /> (optional)</li><li><MadCap:variable name="General.EMS&#160;Desktop Client" /></li><li>Integration to Microsoft Exchange</li></ol></li></ol></li>
        </ol>
        <h2><a name="Deployment_Types"></a>Deployment Types</h2>
        <p>There are three deployment&#160;types for Skype for Business:</p>
        <ol class="number-list">
            <li><span class="bold">Skype for Business Server 2015 On Premise</span>: This deployment for Skype for Business does not retain a token and requires authentication every 8 hours. As a result, you will be asked to sign in every 8 hours.&#160;</li>
            <li><span class="bold">Skype for Business Online</span>: This deployment retains the token so only an initial authentication is required.&#160;</li>
            <li><span class="bold">Hybrid</span>: This deployment has the same authentication method as the Online deployment. Please follow the Skype for Business Online Integration steps for configuration. </li>
        </ol>
        <p class="box-note"><span class="bold">NOTE</span>:&#160;EMS&#160;Software uses Unified Communications Web API&#160;2.0 to integrate with Skype for Business Server and Skype for Business Online. </p>
        <div class="TitleandImage">
            <p class="title">Skype for Business Authentication and Authorization Sequence Diagram</p>
            <p>
                <img class="PDFlarge" src="../Images/Skype_CG1.png" />
            </p>
        </div>
        <div class="note-box note">
            <p><span class="bold">Note:</span> Ensure that you have Exchange Web services component deployed in your environment.&#160;</p>
        </div>
        <h2><a name="Integrate_with_the_Skype_for_Business_Server"></a>Integrate with Skype for Business Server</h2>
        <ol class="number-list">
            <li>Set the authentication for Skype for Business.&#160;</li>
            <li>Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab.</li>
            <li>From the Area dropdown, choose <span class="bold">Skype for Business</span>.&#160;<div class="TitleandImage"><p class="title">Everyday User Applications Tab</p><p><img class="PDFmedium" src="../Images/Skype_CG2.png" /></p></div></li>
        </ol>
        <ol start="1" class="number-list" MadCap:continue="true">
            <li>Set the Skype for Business Auto Discover URL parameter. This parameter performs autodiscovery&#160;to find the appropriate server to communicate with. The client machine and the Web server should have access to the AutoDiscover URL. </li>
            <li>Set&#160;the Skype for Business Server Authentication Method. This parameter determines the authentication type that is used to generate a token.&#160;<ul start="1"><li>The Skype for Business (On Premise) server supports three authentication methods:<ol start="1"><li>ADFS (Active Directory Federation Services)&#160;(not supported in EMS Mobile App)</li><li>NTLM/Windows Authentication</li><li>UserName/Password</li></ol><div class="TitleandImage"><p class="title">Parameter Dialog</p><p><img class="PDFlarge" src="../Images/Skype_CG3.png" /></p></div></li></ul></li>
        </ol>
        <ol MadCap:continue="true" class="number-list">
            <li>Navigate to <span class="bold">System Administration</span> &gt;&#160;<span class="bold">Everyday User Applications</span> and set the Platform Services API URL parameter to Platform Services URL.</li>
        </ol>
        <p>
            <img src="../../EMSRoomSignApp/44.1/Images/image11.png" />
        </p>
        <ol MadCap:continue="true" class="number-list">
            <li>Add EMS Applications to the Allowed Domains List. UCWA utilizes xframe and cross-domain scripting to accomplish the user authentication to leverage the integration. Therefore, EMS applications must be added to a whitelist within the Skype for Business implementation. The whitelist needs to be updated on each of the servers that a user could leverage. For more information, please see <a href="https://ucwa.skype.com/documentation/itadmin-configuration">here</a>. <ul MadCap:continue="true"><li>At a minimum, customers will need to whitelist the EMS&#160;Web App and EMS&#160;Mobile App conferencing URL (trailing forward slash is required). Please see examples below:<ul><li>EMS&#160;Web App: https://servername.domain/EMSWebApplicationName/ConfrencingLogin.aspx/<ul><li>Any combination of this URL will need to be whitelisted (e.g., if there is a different URL for Internal versus External or Mobile Web Access).</li></ul></li><li>EMS&#160;Mobile App: <br />emssoftware://skype/x<ul><li>If the customer re-Packages the EMS&#160;Mobile App, the same URL should be used.</li></ul></li></ul></li><li>Optionally, whitelisting the EMS Web server will facilitate both test and prod environments without adding multiple single entries. Please consult your organization's IT&#160;department and provide them with the following <a href="https://ucwa.skype.com/documentation/itadmin-configuration">steps</a>. </li></ul></li>
        </ol>
        <p class="box-note"><span class="bold">NOTE</span>: When testing Skype for Business Integration, ensure you are using a whitelisted <span class="bold">FULLY QUALIFIED DOMAIN</span>. Most browsers will throw a cross domain error unless the server name is whitelisted without FDQN.<br />For example: <span class="bold">http://xxxx.servername.com/emswebapp </span>this is different than <span class="bold">http://xxxx/emswebapp </span><br />and different than <span class="bold">https://xxxxx.servername.com/emswebapp</span></p>
        <ol start="8" class="number-list">
            <li>Skype certificates. The client devices and EMS Servers need to be able to trust the certificates that are installed on the Skype servers within the Skype implementation. Customers can use private certificates that the Web server has been configured to trust.</li>
        </ol>
        <h4>Integration with Skype for Business Online</h4>
        <ol class="number-list">
            <li>Create a Skype for Business App in Azure AD:<ol><li>Sign into the <a href="https://portal.azure.com/">Azure Management portal</a>.</li><li> Set the Azure Active Directory</li><li>Select App registration. </li><li>Click New Application registration.</li><li>Enter the required information, including:<ol style="list-style-type: lower-roman;"><li>Name of your application (e.g., EMS SFB).</li><li>Application type &gt; Native.</li><li>Conferencing URI (please ensure the trailing slash).</li><li>Click <span class="bold">Create</span>.</li></ol></li></ol></li>
        </ol>
        <p>
            <img class="PDFmedium" src="../../Resources/Images/SkypeConfig1.png" />
        </p>
        <ol class="number-list" MadCap:continue="true">
            <li>Modify the Skype for Business App permissions:<ol><li>Click on the Skype for Business App from the App Registrations.</li><li>Click Required Permissions.</li><li>Click Add.<br /><img src="../../Resources/Images/SkypeConfig2.png" class="PDFlarge" /><br /></li><li>Select all permissions for Skype for Business online.<br /><img src="../../Resources/Images/Config3.png" class="PDFmedium" /><br /></li><li>Select Windows Active Directory and choose only "Sign in and read user profile."<br /><img src="../../Resources/Images/SkypeConfig3.png" class="PDFmedium" /><br /></li><li>Click <span class="bold">Save</span>. </li></ol><div class="note-box note"><p><span class="bold">Note:</span>&#160;From this Skype for Business application, users can add multiple URI&#160;(e.g., for testing or production URI) without creating separate Skype for Business apps for each environment.</p></div><ol start="7"><li>Note the Client ID.&#160;This will need to be added to EMS&#160;parameters. <br /><img class="PDFlarge" src="../../Resources/Images/SkypeConfig5.png" /><br /></li></ol></li>
            <li>Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications tab. From the Area dropdown, choose Skype for Business. <ul><li>Set the Azure Active Directory Client ID parameter. This parameter determines the ID of the registered application. For more information regarding setting this parameter, click <a href="https://msdn.microsoft.com/en-us/skype/ucwa/registeringyourapplicationinazuread">here</a>. Please refer to the above steps to create ClientID. </li><li>Set the Azure Active Directory Tenant parameter. This parameter determines the name of the AAD tenant. For more information regarding setting this parameter, click <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-howto-tenant">here</a>.</li><li>Skype for Business AutoDiscover URL. This parameter performs autodiscovery to find the appropriate server to communicate with. For more information regarding setting this parameter, click <a href="https://msdn.microsoft.com/en-us/skype/ucwa/authenticationusingazuread">here</a>. The client machine and the Web server should have access to the autodiscover URL.</li><li>Skype for Business Server Authentication Method. This parameter determines the authentication type that is used to generate a token. The Skype for Business (Online) only supports Oauth authentication method:<p><img src="../../EMSRoomSignApp/44.1/Images/image12.png" /></p></li></ul></li>
            <li>Configure the Reply&#160;URL.</li>
            <ul>
                <li>&#160;EMS&#160;Mobile App:<ol style="list-style-type: lower-alpha;"><li>Refer to the steps outlined in this <a href="https://docs.microsoft.com/en-us/azure/app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication#a-nameadvanced-aalternative-method-manually-configure-azure-active-directory-with-advanced-settings">documentation</a>.</li><li>In the Reply URL field, insert emssoftware://skype/x.</li></ol><div class="note-box warning"><p><span class="bold">Warning</span>: The cache must be cleared in EMS&#160;Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.&#160;</p></div></li>
                <ul MadCap:continue="true">
                    <li>EMS Web App:<ul><li>In the Reply URL field, insert the root URL:<ul><li>Skype for Business Reply URL = https://loripsor/ConferencingLogin.aspx (where EMS Web App URL = htttps://loripsor.emswebapp.com and Root URL = loripsor)</li></ul></li></ul></li>
                </ul>
            </ul>
        </ol>
        <p class="box-note"><span class="bold">NOTE</span>:&#160;When updating the EMS Web App, re-enter/reissue the secret key (from EMS Platform Services) in the new web.config file.  You may need to add https://login.microsoftonline.com and EMS Web App server in the same Internet zone. This is how Microsoft verifies and sends the token key back to EMS Web App/Platform Services server.</p>
        <h2><a name="Connect_EMS_Web_App_Platform_Services"></a>Connect EMS Web App&#160;to Platform Services</h2>
        <p>To integrate with Skype for Business, EMS Web App must connect to EMS Platform Services.&#160;</p>
        <ol class="number-list">
            <li>Navigate to the EMS Platform Services Admin Portal.&#160;</li>
            <li>Select Integrations. Under Clients, click on the EMS Web App link.</li>
            <li>Click the Reset Secret button and copy the generated Secret.</li>
            <li>In the web.config file located in the designated folder for your current version of EMS, insert the copied Secret&#160;ID into the value field.&#160;</li>
        </ol>
        <div class="indent"><pre>&#160; &#160; &lt;add key="platformServicesSecret" value="YourSecretID" /&gt;</pre>
        </div>
        <div class="note-box important">
            <p class="note-box.important"><span class="bold">IMPORTANT:</span> EMS Cloud Services customers do not need to generate a Secret or insert it into the web.config file (Steps 3 through 4).</p>
        </div>
        <ol start="5" class="number-list">
            <li>Clear the cache in EMS Platform Services by navigating&#160;back to the EMS Platform Services Admin Portal and clicking the Clear Cache button.&#160;</li>
            <li>In the EMS&#160;Desktop Client, navigate to System Administration &gt;&#160;Settings&#160;&gt;&#160;Parameters &gt;&#160;Everyday User Applications. Configure the Platform Services API&#160;URL&#160;parameter. Click Close. </li>
        </ol>
        <p>
            <img src="../Images/Skype_ParamforWebApp.PNG" class="PDFlarge" />
        </p>
        <h2><a name="Configure_Skype_for_Business_on_Global_Templates"></a>Configure Skype for Business on Global Templates</h2>
        <p class="box-important"><span class="bold">IMPORTANT</span>:&#160;Skype for Business can now be configured on the EMS&#160;Platform Services Admin UI. </p>
        <ol start="1" class="number-list">
            <li>Log into EMS Desktop Client or the EMS&#160;Platform Services Admin UI to enable the global parameters for&#160;Skype for Business. </li>
            <li>In the EMS&#160;Desktop Client, navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab.&#160;<ol start="1"><li>From the Area dropdown, choose <span class="bold">Integration to Microsoft Exchange</span>.</li><li>Select <span class="bold">Enable Skype for Business</span>. Click <span class="bold">Edit</span>.</li><li>The default value is No. Set the Description to <span class="bold">Yes</span>.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
        </ol>
        <p class="title">Configuring Skype for Business on a Global Template</p>
        <p>
            <img src="../Images/Skype_CG5.png" class="PDFlarge" />
        </p>
        <ol start="2" class="number-list">
            <li>Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span>.&#160;<ol start="1"><li>From the Area dropdown, choose <span class="bold">System</span>.</li><li>Select <span class="bold">Platform Services URL</span>. Click <span class="bold">Edit</span>.</li><li>Enter the Value (enter the URL for Platform Services) (e.g., https://serverURL/{PlatformServicesName}.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
            <li>
                Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications.
    <ol start="1" MadCap:continue="true"><li>From the Area dropdown, choose <span class="bold">Skype for Business</span>.</li><li>Select Enable Skype for Business. Click <span class="bold">Edit</span>.</li><li>The default value is No. Set the Description to <span class="bold">Yes</span>.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
            <li>
                <p>In the Everyday User Application Settings, check the <span class="bold">Enable Integration to Microsoft Exchange</span> box.</p>
            </li>
        </ol>
        <h2><a name="Configure_Skype_for_Business_on_a_Process_Template_Level"></a>Configure Skype for Business on a Process Template Level</h2>
        <div class="note-box note">
            <p><span class="bold">NOTE:</span> Changing the parameters on a template level will override the global settings.</p>
        </div>
        <ol start="1" class="number-list">
            <li>Navigate to <span class="bold">Configuration</span> &gt; <span class="bold">Everyday User Applications</span> &gt; <span class="bold">Everyday User Process Templates</span>.</li>
            <li>Click <span class="bold">New</span>.</li>
            <li>In the Everyday User Application Settings, check the <strong>Enable Integration to Microsoft Exchange</strong> box.&#160;</li>
            <li>Navigate to the <span class="bold">Parameters</span> tab.</li>
            <li>Filter the parameters by typing "Skype" in the Filter field.&#160;</li>
            <li>Click on the <span class="bold">Enable Skype for Business </span>parameter and click <span class="bold">Edit</span>. The Edit Parameter dialog box appears.</li>
            <li>The default value is No. Select <span class="bold">Yes</span> from the Enable Skype for Business dropdown. Click <span class="bold">OK</span> on the Edit Parameter dialog box.&#160;</li>
            <li>Click <span class="bold">OK</span> on the Everyday User Process Template box.</li>
            <li>Click <span class="bold">Close</span>.&#160;</li>
        </ol>
        <p class="title">Configuring Skype for Business on a Process Template Level</p>
        <p>
            <img src="../Images/Skype_CG6.png" class="PDFmedium" />
        </p>
        <div class="note-box warning">
            <p><span class="bold">WARNING:</span> The cache must be cleared in Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.&#160;</p>
        </div>
        <h2><a name="Configure_Skype_for_Business_on_Existing_Templates"></a>Configure Skype for Business on Existing Templates</h2>
        <p>To configure Skype for Business in existing templates:</p>
        <ol start="1" class="number-list">
            <li>In the EMS Desktop Client, navigate to <span class="bold">Configuration</span> &gt; <span class="bold">Everyday User Applications</span> &gt; <span class="bold">Everyday User Process Templates</span>.</li>
            <li>Click on the existing template for which you want to enable Skype for Business.</li>
            <li>Click <span class="bold">Edit</span>. The template dialog box appears.&#160;</li>
            <li>Ensure that the&#160;<span class="bold">Enable Integration to Microsoft Exchange</span> box is checked in the Everyday User Application Setting section.&#160;</li>
            <li>Navigate to the <span class="bold">Parameters</span> tab.</li>
            <li>Filter the parameters by typing "Skype" in the Filter field.&#160;</li>
            <li>Click on the <span class="bold">Enable Skype for Business</span> parameter and click <span class="bold">Edit</span>. The Edit Parameter dialog box appears.<ol start="1"><li>The default value is No. Select <span class="bold">Yes </span>from the Enable Skype for Business dropdown.</li><li>Click <span class="bold">OK</span> on the Edit Parameter dialog box.&#160;</li></ol></li>
            <li>Click <span class="bold">OK</span> on the Everyday User Process Template box.</li>
            <li>Click <span class="bold">Close</span>.&#160;</li>
        </ol>
        <p class="title">Configuring Skype for Business in an Existing Template</p>
        <p>
            <img src="../Images/Skype_CG7.png" class="PDFmedium" />
        </p>
        <div class="note-box warning">
            <p><span class="bold">WARNING:</span> The cache must be cleared in EMS Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.</p>
        </div>
        <div class="note-box note">
            <p><span class="bold">NOTE:</span> Once a Skype meeting is added to a reservation, a&#160;Skype meeting flag—indicating that the reservation has a Skype meeting—appears in the Booking Summary tab for the reservation in the EMS Desktop Client. Additionally, the Skype ID will appear in&#160;the Properties tab for the reservation. A reservation-level display field named Skype Meeting in the Query Builder will indicate there is a Skype meeting in the reservation.</p>
        </div>
    </body>
</html>